<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/cart.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <title>Couchly | Cart</title>
</head>
<body>
 
    <% include('../partials/nav') %>
    
    <section id="cart">
        <h1>My Cart</h1>
        
       

        <div class="cart-Table">
            <table width="50%">
                <tr>
                    <th>Product</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total price</th>
                    <th>Condition</th>
                </tr>

                <% let totalPrice = 0; %>
                <% if (cartItems.length === 0) { %>
                    <p>Your cart is empty.</p>
                <% }else { %>
                    <% cartItems.forEach(item => { %>
                        <tr>   
                            <td><img src="/imgs/<%= item.image %>" alt="bed1" width="120" height="120"></td>
                            <td><%= item.name %></td>
                            <td><%= item.price %></td>
                            <td><%= item.quantity %></td>
                            <td><%= item.price * item.quantity %></td>
                            <td><button>Remove</button></td>
                        </tr>
                        <% totalPrice += item.price * item.quantity; %>
                    <% }); %>
                <% } %>
            </table>
        </div>
        <div class="proceed-Table">
            <table width="43%">
                <tr>
                    <th colspan="3">Cart Total</th>
                </tr>
                <tr>
                    <td><h5>Total</h5></td>
                    <td></td>
                    <td><h5 id="total"><%=totalPrice%> </h5></td>
                </tr> 
                <tr>
                    <td></td>
                    <td><button><a href="/checkout">Proceed to checkout</a></button></td>
                    <td></td>
                </tr>
            </table>
        </div>
    </section>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("total").textContent = "$" + totalPrice.toFixed(2);
        });
    </script>

</body>
</html>